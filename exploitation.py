import subprocess
import logging

# Configure logging
logging.basicConfig(level=logging.DEBUG)
logger = logging.getLogger(__name__)

def run_sqlmap(target_url):
    try:
        command = ["sqlmap", "-u", target_url, "--batch", "--output-dir=./sqlmap_output"]
        result = subprocess.run(command, capture_output=True, text=True)
        if result.returncode == 0:
            logger.debug(f"SQLMap run successfully for {target_url}")
            return result.stdout
        else:
            logger.error(f"SQLMap failed for {target_url}: {result.stderr}")
            return result.stderr
    except Exception as e:
        logger.error(f"Error running SQLMap: {e}")
        return str(e)
